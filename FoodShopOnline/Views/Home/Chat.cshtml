@using FoodShopOnline.Common
@{
    var session = (UserLogin)Session[FoodShopOnline.Common.CommonConstants.User_Session];
}
@section jsFooter{
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.1.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        $(function () {
            // Reference the auto-generated proxy for the hub.
            var chat = $.connection.chatHub;
            var displayname = @session.UserName;
            // Create a function that the hub can call back to display messages.
            chat.client.addNewMessageToPage = function (name, message) {
                // Add the message to the page.
                $('#discussion').append('<li><strong>' + htmlEncode(name)
                    + '</strong>: ' + htmlEncode(message) + '</li>');
            };
            // Set initial focus to message input box.
            $('#message').focus();
            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#sendmessage').click(function () {
                    // Call the Send method on the hub.
                    chat.server.send($(displayname).val(), $('#message').val());
                    // Clear text box and reset focus for next comment.
                    $('#message').val('').focus();
                });
            });
        });
        // This optional function html-encodes messages for display in the page.
        function htmlEncode(value) {
            var encodedValue = $('<div />').text(value).html();
            return encodedValue;
        }
    </script>
}
@if (session != null)
{
    <div class="chat">
        <div class="container text-center">
            <div class="row">
                <div class="round hollow text-center">
                    <a href="#" id="addClass"><span class="glyphicon glyphicon-comment"></span></a>
                </div>
            </div>
        </div>
        <div class="popup-box chat-popup" id="qnimate" style="margin-right: 30px">
            <div class="popup-head">
                <div class="popup-head-left pull-left"><img src="@session.Avatar" alt="iamgurdeeposahan" style="height: 40px; width: 40px"> @session.UserName</div>
                <div class="popup-head-right pull-right">
                    @*<div class="btn-group">
                            <button class="chat-header-button" data-toggle="dropdown" type="button" aria-expanded="false">
                                <i class="glyphicon glyphicon-cog"></i>
                            </button>
                        </div>*@
                    <button data-widget="remove" id="removeClass" class="chat-header-button pull-right" type="button">X</button>
                </div>
            </div>
            <div class="popup-messages">
                <div class="direct-chat-messages">
                    <div class="chat-box-single-line">
                        <abbr class="timestamp">October 8th, 2015</abbr>
                    </div>
                    <!-- Message. Default to the left -->
                    <div class="direct-chat-msg doted-border">
                        <div class="direct-chat-info clearfix">
                            <span class="direct-chat-name pull-left">Osahan</span>
                        </div>
                        <!-- /.direct-chat-info -->
                        <img alt="message user image" src="@session.Avatar" class="direct-chat-img"><!-- /.direct-chat-img -->
                        <div class="direct-chat-text">
                            <input type="hidden" id="displayname" />
                        </div>
                        <div class="direct-chat-info clearfix">
                            <span class="direct-chat-timestamp pull-right">3.36 PM</span>
                        </div>
                        <div class="direct-chat-info clearfix">
                            <span class="direct-chat-img-reply-small pull-left">

                            </span>
                            <span class="direct-chat-reply-name">Admin</span>
                        </div>
                        <!-- /.direct-chat-text -->
                    </div>
                    <!-- /.direct-chat-msg -->
                    <!--<div class="chat-box-single-line">
                        <abbr class="timestamp">October 9th, 2015</abbr>
                    </div>-->
                    <!-- Message. Default to the left -->
                    <!--<div class="direct-chat-msg doted-border">
                        <div class="direct-chat-info clearfix">
                            <span class="direct-chat-name pull-left">Osahan</span>
                        </div>-->
                    <!-- /.direct-chat-info -->
                    <!--<img alt="iamgurdeeposahan" src="@session.Avatar" class="direct-chat-img">--><!-- /.direct-chat-img -->
                    <!--<div class="direct-chat-text">
                        Hey bro, how’s everything going ?
                    </div>
                    <div class="direct-chat-info clearfix">
                        <span class="direct-chat-timestamp pull-right">3.36 PM</span>
                    </div>
                    <div class="direct-chat-info clearfix">
                        <img alt="iamgurdeeposahan" src="@session.Avatar" class="direct-chat-img big-round">
                        <span class="direct-chat-reply-name">Singh</span>
                    </div>-->
                    <!-- /.direct-chat-text -->
                    <!--</div>-->
                    <!-- /.direct-chat-msg -->
                </div>
            </div>
            <div class="popup-messages-footer">
                @*<textarea id="status_message" placeholder="Type a message..." rows="10" cols="40" name="message" ></textarea>*@
                <input type="text" id="message" placeholder="Type a message..."  />
                <input type="button" id="sendmessage" value="Send" />
                <ul id="discussion">
                </ul>
                <div class="btn-footer">
                    <button class="bg_none"><i class="glyphicon glyphicon-film"></i> </button>
                    <button class="bg_none"><i class="glyphicon glyphicon-camera"></i> </button>
                    <button class="bg_none"><i class="glyphicon glyphicon-paperclip"></i> </button>
                    <button class="bg_none pull-right"><i class="glyphicon glyphicon-thumbs-up"></i> </button>
                </div>
            </div>
        </div>
    </div>
}

